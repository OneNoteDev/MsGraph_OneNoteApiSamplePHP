Microsoft Graph OneNote API Пример PHP для чтения
---------------------------------------------

Создано Microsoft Corporation, 2017. Предоставляется как есть без гарантии. Товарные знаки, упомянутые в этой статье, являются собственностью их владельцев.

### Функции API, демонстрируются в этом примере

В этом примере рассматриваются указанные ниже аспекты API. Дополнительные сведения можно найти по ссылкам ниже.

-	[Вход в систему пользователя](https://developer.microsoft.com/ru-ru/graph/docs/authorization/app_authorization)
-	[ПОЛУЧИТЕ страницы пользователя OneNote](https://developer.microsoft.com/ru-ru/graph/docs/api-reference/beta/api/page_get)
-	[Отправьте простой HTML на новую страницу быстрых заметок OneNote](https://developer.microsoft.com/ru-ru/graph/docs/api-reference/beta/api/notes_post_pages)
-	[POST-сообщение из нескольких частей с данными изображения, включенными в запрос \*](http://msdn.microsoft.com/ru-ru/library/office/dn575432.aspx)
-	[Страница POST с URL, отображаемым как изображение \*](http://msdn.microsoft.com/ru-ru/library/office/dn575431.aspx)
-	[Страница POST с HTML, отображаемым как изображение \*](http://msdn.microsoft.com/ru-ru/library/office/dn575432.aspx)
-	[Страница POST с файлом PDF, представленным и прикрепленным \*](http://msdn.microsoft.com/ru-ru/library/office/dn655137.aspx)

\* Указывает на документацию для POST-запросов, состоящих из нескольких частей, к API OneNote перед его интеграцией в Microsoft Graph API. Документация для приведенных примеров запросов работает на момент создания этого образца, но следует помнить, что возможны изменения.

### Необходимые компоненты

**Инструменты и Библиотеки** которые вам потребуется скачать, установить и настроить для вашей среды разработки.

Пример PHP работает на веб-сервере. Клиентский браузер должен иметь доступ к веб-серверу для завершения рукопожатия. Убедитесь, что вы установили файлы PHP так, чтобы:

-	Используемый вами веб-сервер доступен из Интернета.
-	На веб-сервере установлен PHP с включенным пакетом cURL  
-	У вас есть обычный URL с именем хоста (а не просто IP-адресом), который можно использовать для URL перенаправления. При запуске этого приложения на рабочем столе потребуется изменить файл hosts (в C:\\Windows\\System32\\drivers\\etc для компьютеров с Windows и/привате/ЕТК для компьютеров Mac) и сопоставить IP-адреса локального сервера с новым доменным именем, как показано в приведенном ниже примере. ![Измените файл Hosts и сопоставьте IP-адрес локального сервера с новым доменным именем.](images/HostsFile.png)

**Учетные записи**

-	Как разработчик, вам нужно [иметь учетную запись Microsoft и получить строку идентификатора клиента](http://msdn.microsoft.com/ru-ru/library/office/dn575426.aspx), чтобы ваше приложение могло проходить аутентификацию с помощью конечной точки Microsoft Azure AD v2.0.
-	В качестве пользователя примера вам понадобится учетная запись Microsoft (Azure AD / Org ID или учетная запись MSA), чтобы API OneNote мог отправлять страницы в OneDrive.

### Зарегистрировать образец

После настройки вашего веб-сервера, описанного выше,....

1.	Клонируйте Git-репозиторий в папку на вашем локальном компьютере.
2.	Перейдите на страницу [регистрации приложения Microsoft](https://account.live.com/developers/applications/index).
3.	Настоятельно рекомендуется получить свой собственный идентификатор клиента, секретный и URI перенаправления. Вы можете получить свой собственный идентификатор клиента, секрет клиента и URI перенаправления. [здесь](http://developer.microsoft.com/ru-ru/graph/docs/authorization/auth_register_app_v2)
4.	Для локальной разработки образец использует http://localhost:8888/callback.php в качестве URI перенаправления. Для производства вы должны изменить это так, чтобы он указывал на домен вашего приложения при размещении на хосте. Если корневым URL-адресом развертывания является https://onenoteapisamples.com, укажите https://onenoteapisamples.com/callback.php в качестве URL-адреса перенаправления (как в следующем примере). Этот URL должен точно соответствовать развернутому URL перенаправления. Имя корневого домена должно быть уникальным, поэтому, если вы используете один домен для тестирования, а другой для производства, вам необходимо зарегистрировать отдельные идентификаторы и секреты клиента для каждого домена. [Укажите настройки API на портале регистрации приложений Microsoft](images/OneNoteMSAScreen.png). 
>Примечание. Chrome и Firefox не позволяют устанавливать файлы cookie на локальном хосте, и поэтому аутентификация не будет работать в этих браузерах во время разработки, если вы решите перенаправить на локальный хост.

### Настройте образец

1.	Замените следующие заполнители в файлах callback.php и index.php соответствующими значениями на странице настроек приложения:
	1.	Замените CLIENT\_ID значением идентификатора клиента.
	2.	Замените CLIENT\_SECRET на секретное значение клиента.
	3.	Замените REDIRECT\_URI\_PATH значением корневого URL-адреса развертывания. URL-адрес развертывания состоит из "http://" и URL-адреса корневого домена, поэтому если URL-адрес перенаправления выглядит так http://onenoteapisamples.com/callback.php, URL-адрес развертывания — "http://onenoteapisamples.com". Во время выполнения значение URL-адреса перенаправления преобразуется в «http://onenoteapisamples.com/callback.php».
2.	Поместите образцы файлов в корневой каталог на вашем веб-сервере.
3.	Откройте браузер и перейдите на страницу .php по умолчанию.
4.	Войдите в систему, используя свою учетную запись Microsoft, и позвольте приложению создавать страницы в своих записных книжках OneNote.

### Сведения о версии


### Сведения о версии

| Дата | Изменить |
| -------------- | ---------------------------------- ---------------------------------------------- |
| Май 2017 | Обновлено для использования базового URL-адреса Microsoft Graph v1.0 для ресурсов OneNote |
| Апрель 2017 | Обновлен для использования конечных точек Microsoft Graph API. |
| Май 2014 | Первоначальный публичный релиз для этого примера кода. |

### Известные проблемы

-	Если вы запускаете образец на веб-сервере в домашней сети и у вас нет фиксированного IP-адреса и назначенного доменного имени, вам может потребоваться использовать поставщика DDNS, а затем перенаправить порты HTTP / S на ваш локальный сервер.
-	Файлы PHP в этом примере содержат окончания строк CRLF. Вам нужно будет сохранить эти окончания строк при открытии и редактировании этих файлов в редакторе. См. [Работа с окончаниями строк](https://help.github.com/articles/dealing-with-line-endings#platform-all) для получения инструкций о том, как сохранить окончания строк CRLF на всех платформах.

### Учиться больше

-	Посетить центр разработчиков [dev.onenote.com](http://dev.onenote.com)
-	Свяжитесь с нами на сайте [StackOverflow (тег OneNote)](http://go.microsoft.com/fwlink/?LinkID=390182)
-	Подпишитесь на нас в [Twitter @onenotedev](http://www.twitter.com/onenotedev)
-	Читайте наш [блог для разработчиков OneNote](http://go.microsoft.com/fwlink/?LinkID=390183)
-	Исследуйте API с помощью [Graph Explorer](https://developer.microsoft.com/ru-ru/graph/graph-explorer)
-	[Справочная документация по API](https://developer.microsoft.com/ru-ru/graph/docs/api-reference/beta/resources/notes)
-	[Известные проблемы](https://developer.microsoft.com/ru-ru/graph/docs/overview/release_notes)
-	[Начало работы](https://developer.microsoft.com/ru-ru/graph/docs/get-started/get-started) с Microsoft Graph API

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
